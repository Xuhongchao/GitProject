package com.pxene.odata;

import java.util.HashMap;
import java.util.Iterator;
import java.util.Set;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import org.junit.Test;

/**
 * Created by @author xuhongchao on @date 2017年 月 日 下午2:00:53
 */

public class CoreTest {
	@Test
	public void testName() throws Exception {
		String[] strs = { "auto.com?s", "auto.com?s", "auto.com?s" };

		String compile = ".*auto.com.*";
		Pattern p = Pattern.compile(compile);
		for (String str : strs) {
			Matcher m = p.matcher(str);
			boolean b = m.matches();
			System.out.println(b);
		}
	}

	@Test
	public void test() throws Exception {
		String paramReg = "NULL";
		String[] params = paramReg.split("\t");
		if (params.length == 1 && "NULL".equals(params[0])) {
			System.out.println("1");
		}
	}

	@Test
	public void test2() throws Exception {
		HashMap<String, String> container = new HashMap<String, String>();
		container.put("1", "1");
		container.put("2", "2");
		container.put("3", "3");
		System.out.println(container.size());
		container.clear();
		System.out.println(container.size());

		Set<String> keys = map.keySet();// 取出所有key的集合
		Iterator<String> it = keys.iterator();// 获取Iterator对象
		while (it.hasNext()) {
			String key = it.next(); // 取出key
			String value = container.get(key); // 根据key取出对应的值

			/*
			 * 分两步走： 首先让每一个url过（domain + urlReg） ； 然后再一个一个的过参数正则（参数正则可能有多个）；
			 * 全过之后就+1；
			 */
			String url = decode(killBeginOfUrl(value));
			Matcher m = p.matcher(url);
			b = m.matches();
			if (b) {
				String[] params = paramReg.split("\t");
				if (params.length == 1 && "NULL".equals(params[0])) {
					// 如果参数只为NULL，该情况是主域名的情况，直接跳出输出b
					break;
				}
				for (int i = 0; i < params.length; i++) {
					if ("NULL".equals(params[i])) {
						continue;
					}
					p = Pattern.compile(params[i]);
					m = p.matcher(url);
					b = m.find();
					if (!b) { // 有一个不同即为不同
						break;
					}
				}
			}
			if (b) {
				// 将指标+1
				index++;
				// 并记录一下通过的url和num
				container.put(key, value);
			}

		}
	}

	@Test
	public void test3() throws Exception {
		String string = "https://btrace.qq.com/kvcollect?BossI";
		System.out.println(string.startsWith("https"));

	}

}
